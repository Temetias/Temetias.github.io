<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#e6e6e6 name=theme-color> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.ico rel=icon type=image/ico> <style>main.svelte-16jbveb{position:relative;max-width:56em;padding:2em;margin:8vh auto 0 auto;box-sizing:border-box}@media(max-width:769px){main.svelte-16jbveb{margin:4vh auto 0 auto}}.nav-wrap.svelte-vsqtn4.svelte-vsqtn4{display:flex;justify-content:space-between;margin:0 auto;align-items:stretch;width:100vw;max-width:1200px}.primary-nav.svelte-vsqtn4.svelte-vsqtn4{font-weight:500;display:flex;align-items:stretch;justify-content:space-between}ul.svelte-vsqtn4.svelte-vsqtn4{display:flex;align-items:stretch;justify-content:flex-start}li.svelte-vsqtn4.svelte-vsqtn4{padding:0 1em;display:block}a.svelte-vsqtn4.svelte-vsqtn4{font-size:1.4em}.primary-nav.svelte-vsqtn4 a.svelte-vsqtn4{text-decoration:none;text-transform:capitalize}.primary-nav.svelte-vsqtn4 a.svelte-vsqtn4::before{content:"<";margin-right:1px;transition:color .2s}.primary-nav.svelte-vsqtn4 a.svelte-vsqtn4::after{content:"/>";margin-left:1px;transition:color .2s}.primary-nav.svelte-vsqtn4 a.svelte-vsqtn4:hover::after,.primary-nav.svelte-vsqtn4 a.svelte-vsqtn4:hover::before{color:red}.primary-nav.svelte-vsqtn4 a[aria-current].svelte-vsqtn4{color:red}.socials.svelte-vsqtn4.svelte-vsqtn4{padding-right:2em}.socials.svelte-vsqtn4 a.svelte-vsqtn4{font-size:1.6em}.github.svelte-vsqtn4.svelte-vsqtn4,.linkedin.svelte-vsqtn4.svelte-vsqtn4,.twitter.svelte-vsqtn4.svelte-vsqtn4{transition:color .2s}.twitter.svelte-vsqtn4.svelte-vsqtn4:hover{color:#00acee}.github.svelte-vsqtn4.svelte-vsqtn4:hover{color:#333}.linkedin.svelte-vsqtn4.svelte-vsqtn4:hover{color:#0e76a8}@media(max-width:660px){.socials-nav.svelte-vsqtn4.svelte-vsqtn4{display:none}.nav-wrap.svelte-vsqtn4.svelte-vsqtn4{justify-content:center}ul.svelte-vsqtn4.svelte-vsqtn4{padding:0;justify-content:center}}@media(max-width:480px){a.svelte-vsqtn4.svelte-vsqtn4{font-size:1.2em}}.fa-svelte.svelte-1d15yci{width:1em;height:1em;overflow:visible;display:inline-block}h1.svelte-1r59cqt{margin-bottom:1em}.content.svelte-1r59cqt{margin:2em 0}.blog-disclaimer.svelte-1r59cqt{display:block;border-bottom:1px solid rgba(0,0,0,.12);border-top:1px solid rgba(0,0,0,.12);padding:2em 0;margin-top:5em;font-weight:600}header.svelte-1jdubmn.svelte-1jdubmn{margin-bottom:1em}a.svelte-1jdubmn.svelte-1jdubmn{font-weight:600}span.svelte-1jdubmn.svelte-1jdubmn{color:rgba(0,0,0,.6)}.post-info.svelte-1jdubmn.svelte-1jdubmn{display:flex}.post-info.svelte-1jdubmn img.svelte-1jdubmn{margin:0;border:1px solid #fff;border-radius:50%;width:4em;height:4em}.post-info-inner.svelte-1jdubmn.svelte-1jdubmn{margin-left:1em}.post-info-inner.svelte-1jdubmn span.svelte-1jdubmn{display:block}.divider-dot.svelte-1jdubmn.svelte-1jdubmn,.divider.svelte-1jdubmn.svelte-1jdubmn{display:inline!important}@media(max-width:480px){.divider.svelte-1jdubmn.svelte-1jdubmn{display:block!important}.divider-dot.svelte-1jdubmn.svelte-1jdubmn{display:none!important;color:red}}footer.svelte-1q2oy3t.svelte-1q2oy3t{max-width:56em;padding:0 2em 2em 2em;margin:8vh auto 0 auto;text-align:center}li.svelte-1q2oy3t.svelte-1q2oy3t{display:block}.socials.svelte-1q2oy3t.svelte-1q2oy3t{text-align:start;padding-left:0;margin-bottom:3em}.socials.svelte-1q2oy3t a.svelte-1q2oy3t{font-size:1.4em}a.svelte-1q2oy3t.svelte-1q2oy3t svg{transform:translateY(.15em)}a.svelte-1q2oy3t.svelte-1q2oy3t{text-decoration:none;line-height:2em}@media(min-width:661px){.socials.svelte-1q2oy3t.svelte-1q2oy3t{display:none}}.last-update.svelte-1q2oy3t.svelte-1q2oy3t{color:#585555}</style> <noscript id=sapper-head-start></noscript><title>Managing Event Handlers in Classes</title><noscript id=sapper-head-end></noscript> <link href=/client/67626b8c3455d916c80e/main.js rel=preload as=script><link href=/client/67626b8c3455d916c80e/blog_$slug.3.js rel=preload as=script></head> <body> <div id=sapper> <div class="svelte-vsqtn4 nav-wrap"><nav aria-label=primary class="svelte-vsqtn4 primary-nav"><ul class=svelte-vsqtn4><li class=svelte-vsqtn4><a href=. class=svelte-vsqtn4>TK </a></li> <li class=svelte-vsqtn4><a href=blog class=svelte-vsqtn4 aria-current=page>blog </a></ul></nav> <nav aria-label=social-links class="svelte-vsqtn4 socials-nav"><ul class="svelte-vsqtn4 socials"><li class=svelte-vsqtn4><a href=https://github.com/Temetias class="svelte-vsqtn4 github" aria-label="My github"><svg aria-hidden=true class="fa-svelte svelte-1d15yci" role=img viewBox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill=currentColor></path></svg></a></li> <li class=svelte-vsqtn4><a href=https://twitter.com/Temetias class="svelte-vsqtn4 twitter" aria-label="My twitter"><svg aria-hidden=true class="fa-svelte svelte-1d15yci" role=img viewBox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" fill=currentColor></path></svg></a></li> <li class=svelte-vsqtn4><a href=https://www.linkedin.com/in/teemu-karppinen-1174b1139/ class="svelte-vsqtn4 linkedin" aria-label="My linkedin"><svg aria-hidden=true class="fa-svelte svelte-1d15yci" role=img viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z" fill=currentColor></path></svg></a></ul></nav></div> <main class=svelte-16jbveb> <h1 class=svelte-1r59cqt id=managing-event-handlers-in-classes>Managing Event Handlers in Classes</h1> <header class=svelte-1jdubmn><div class="svelte-1jdubmn post-info"><img alt="Teemu Karppinen" src=/me2.jpg class=svelte-1jdubmn> <div class="svelte-1jdubmn post-info-inner"><a href=https://teemukarppinen.dev class=svelte-1jdubmn>Teemu Karppinen</a> <span class=svelte-1jdubmn><span class="svelte-1jdubmn divider">7/12/2020</span> <span class="svelte-1jdubmn divider-dot">‚Ä¢</span> <span class="svelte-1jdubmn divider">3 min read</span></span></div></div></header> <div class="svelte-1r59cqt content"><p>If you've worked with TypeScript, you might've noticed that many of library authors have a weird obsession of writing libraries as classes. Or even worse, write class wrappers around already nice, clean, functional API's just for the sake of that "being the TypeScript way of doing things". Don't get me wrong: I'm not saying the libraries are necessarily bad or shouldn't be used. There are just some pain points that pop up with the OOP approach. Especially when we're talking about an event-driven language like JavaScript.</p> <h2 id=the-problem-üò¨>The Problem üò¨</h2> <p>Lately I've been working on a feature which needs A LOT of event handlers. I'm not going into specifics because it's work stuff, but essentially I have to:</p> <ul> <li>Create a lot of class instances</li> <li>Attach methods of those class instances to different events</li> <li>Handle the detaching of those events in the end of the class instances' lifecycle</li> </ul> <p>The class instances are <a href=https://class-component.vuejs.org/ >vue-class-components</a>, but that's trivial to the actual problem. Just any class API where we might need to attach and detach methods to events applies here. The problem arises when you want to attach and detach class methods while retaining the correct <code>this</code> context.</p> <p>Let's think about this scenario:</p> <p>You have some library with events, for example some sort of map library. You want to attach a method of the class to the event, and detach it later. Easy, right?</p> <p><img alt="alt text" src=/badbind.PNG title="This will lose THIS"></p> <p>You wish! You see, this approach will make the <code>mouseDownHandler</code> lose <code>this</code> context, and be unable to refer to the value it wants to. So in this case, the <code>console.log</code> doesn't print <code>"Hey"</code> but instead we get greeted with the good ol' <code>undefined</code>.</p> <h2 id=the-ugly-solution-ü§Æ>The Ugly Solution ü§Æ</h2> <p>Okay then, let's bind the function. But then that needs to happen inside the lifecycle. And don't forget, we want to refer that bound function later to detach it! So we can't just go <code>map.mouseDown.on(this.mouseDownHandler.bind(this))</code> because <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind>Function.bind</a> creates a new function and that's the function we want to be .offing later.</p> <p>So what we need to do is to have a separate variable for the function and alter that one. Something like this:</p> <p><img alt="alt text" src=/uglybind.PNG title="Works, but is ugly"></p> <p>This works but as you can see it's not the most readable approach and gets very boilerplatey fast. And you also need to come up with a new name for the unbound funtion. I've seen some use underscore prefixes like <code>_handleMouseDown</code> but that already is kind of reserved for indicating the intentional hiding of implementation details.</p> <p>Also, as we can see, this doesn't scale that nicely... <img alt="alt text" src=/ugliestbind.PNG title="Works, but there is soo much code"></p> <h2 id=the-less-ugly-solutions-üò™>The (less) Ugly Solutions üò™</h2> <p>Well, the other day it kind of hit me. Instead of focusing too much on the methods, renaming, binding and all that mess, what if we just used some sort of "cleanup callback array"? I tried it and in my opinion this is the least ugly solution to this problem.</p> <p>Check this out: <img alt="alt text" src=/prettybind.PNG title="Works, and is much cleaner to look at"></p> <p>We introduce a new array <code>cleanUps</code> and we do all the bind, .on and .off handling in the mounted hook. The overall lines of code doesn't really change but that's not the point. In my opinion there is still benefits with this approach:</p> <ul> <li>Less weird name suffixes like <code>Unbound</code></li> <li>The logic is in one place</li> <li>More flexible approach. The cleanUps can be used for other things and from other methods.</li> </ul> <p>You could also consider implementing a utility function if you find yourself doind a lot of attaching. Something like this: <img alt="alt text" src=/fancybind.PNG title="Everything is nicer when you use a function"></p> <p>Utility functions... Can't have enough of those, right? üòÖ</p> <h2 id=to-close-things-up>To Close Things Up</h2> <p>What I showed here is not necessarily the golden solution you were looking for. But it is, in my opinion, a decent workaround to an annoying problem. Overall, all this would've been avoided by not using class based API in the first place and avoiding the use of <code>this</code> altogether. But we don't always have the benefit of choosing the libraries we work with. It's situations like these, when workarounds like this are valuable.</p> </div> <div class="svelte-1r59cqt blog-disclaimer"><span>Hey! If you're looking for a comment section I'm sorry to disappoint you: I haven't had time to make one yet. ü§ê But if you wanna call me out on my bullüí©, just ping me <a href=https://twitter.com/Temetias>@Twitter</a> meanwhile! </span></div></main> <footer class=svelte-1q2oy3t><ul class="svelte-1q2oy3t socials"><li class=svelte-1q2oy3t><a href=https://github.com/Temetias class=svelte-1q2oy3t><svg aria-hidden=true class="fa-svelte svelte-1d15yci" role=img viewBox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill=currentColor></path></svg> /Temetias </a></li> <li class=svelte-1q2oy3t><a href=https://twitter.com/Temetias class=svelte-1q2oy3t><svg aria-hidden=true class="fa-svelte svelte-1d15yci" role=img viewBox="0 0 512 512" xmlns=http://www.w3.org/2000/svg><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" fill=currentColor></path></svg> @Temetias </a></li> <li class=svelte-1q2oy3t><a href=https://www.linkedin.com/in/teemu-karppinen-1174b1139/ class=svelte-1q2oy3t><svg aria-hidden=true class="fa-svelte svelte-1d15yci" role=img viewBox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z" fill=currentColor></path></svg> Teemu Karppinen </a></ul> <span class="svelte-1q2oy3t last-update"></span></footer></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{post:{title:"Managing Event Handlers in Classes",slug:"managing-event-handlers-in-classes",date:new Date(1594512000000),author:"Teemu Karppinen",authorImg:"\u002Fme2.jpg",authorLink:"https:\u002F\u002Fteemukarppinen.dev",content:"\u003Cp\u003EIf you&#39;ve worked with TypeScript, you might&#39;ve noticed that many of library authors have a weird obsession of writing libraries as classes. Or even worse, write class wrappers around already nice, clean, functional API&#39;s just for the sake of that &quot;being the TypeScript way of doing things&quot;. Don&#39;t get me wrong: I&#39;m not saying the libraries are necessarily bad or shouldn&#39;t be used. There are just some pain points that pop up with the OOP approach. Especially when we&#39;re talking about an event-driven language like JavaScript.\u003C\u002Fp\u003E\n\u003Ch2 id=\"the-problem-üò¨\"\u003EThe Problem üò¨\u003C\u002Fh2\u003E\n\u003Cp\u003ELately I&#39;ve been working on a feature which needs A LOT of event handlers. I&#39;m not going into specifics because it&#39;s work stuff, but essentially I have to:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ECreate a lot of class instances\u003C\u002Fli\u003E\n\u003Cli\u003EAttach methods of those class instances to different events\u003C\u002Fli\u003E\n\u003Cli\u003EHandle the detaching of those events in the end of the class instances&#39; lifecycle\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EThe class instances are \u003Ca href=\"https:\u002F\u002Fclass-component.vuejs.org\u002F\"\u003Evue-class-components\u003C\u002Fa\u003E, but that&#39;s trivial to the actual problem. Just any class API where we might need to attach and detach methods to events applies here. The problem arises when you want to attach and detach class methods while retaining the correct \u003Ccode\u003Ethis\u003C\u002Fcode\u003E context.\u003C\u002Fp\u003E\n\u003Cp\u003ELet&#39;s think about this scenario:\u003C\u002Fp\u003E\n\u003Cp\u003EYou have some library with events, for example some sort of map library. You want to attach a method of the class to the event, and detach it later. Easy, right?\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fbadbind.PNG\" alt=\"alt text\" title=\"This will lose THIS\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EYou wish! You see, this approach will make the \u003Ccode\u003EmouseDownHandler\u003C\u002Fcode\u003E lose \u003Ccode\u003Ethis\u003C\u002Fcode\u003E context, and be unable to refer to the value it wants to. So in this case, the \u003Ccode\u003Econsole.log\u003C\u002Fcode\u003E doesn&#39;t print \u003Ccode\u003E&quot;Hey&quot;\u003C\u002Fcode\u003E but instead we get greeted with the good ol&#39; \u003Ccode\u003Eundefined\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Ch2 id=\"the-ugly-solution-ü§Æ\"\u003EThe Ugly Solution ü§Æ\u003C\u002Fh2\u003E\n\u003Cp\u003EOkay then, let&#39;s bind the function. But then that needs to happen inside the lifecycle. And don&#39;t forget, we want to refer that bound function later to detach it! So we can&#39;t just go \u003Ccode\u003Emap.mouseDown.on(this.mouseDownHandler.bind(this))\u003C\u002Fcode\u003E because \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FJavaScript\u002FReference\u002FGlobal_Objects\u002FFunction\u002Fbind\"\u003EFunction.bind\u003C\u002Fa\u003E creates a new function and that&#39;s the function we want to be .offing later.\u003C\u002Fp\u003E\n\u003Cp\u003ESo what we need to do is to have a separate variable for the function and alter that one. Something like this:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"\u002Fuglybind.PNG\" alt=\"alt text\" title=\"Works, but is ugly\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThis works but as you can see it&#39;s not the most readable approach and gets very boilerplatey fast. And you also need to come up with a new name for the unbound funtion. I&#39;ve seen some use underscore prefixes like \u003Ccode\u003E_handleMouseDown\u003C\u002Fcode\u003E but that already is kind of reserved for indicating the intentional hiding of implementation details.\u003C\u002Fp\u003E\n\u003Cp\u003EAlso, as we can see, this doesn&#39;t scale that nicely...\n\u003Cimg src=\"\u002Fugliestbind.PNG\" alt=\"alt text\" title=\"Works, but there is soo much code\"\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"the-less-ugly-solutions-üò™\"\u003EThe (less) Ugly Solutions üò™\u003C\u002Fh2\u003E\n\u003Cp\u003EWell, the other day it kind of hit me. Instead of focusing too much on the methods, renaming, binding and all that mess, what if we just used some sort of &quot;cleanup callback array&quot;? I tried it and in my opinion this is the least ugly solution to this problem.\u003C\u002Fp\u003E\n\u003Cp\u003ECheck this out:\n\u003Cimg src=\"\u002Fprettybind.PNG\" alt=\"alt text\" title=\"Works, and is much cleaner to look at\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EWe introduce a new array \u003Ccode\u003EcleanUps\u003C\u002Fcode\u003E and we do all the bind, .on and .off handling in the mounted hook. The overall lines of code doesn&#39;t really change but that&#39;s not the point. In my opinion there is still benefits with this approach:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ELess weird name suffixes like \u003Ccode\u003EUnbound\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EThe logic is in one place\u003C\u002Fli\u003E\n\u003Cli\u003EMore flexible approach. The cleanUps can be used for other things and from other methods.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EYou could also consider implementing a utility function if you find yourself doind a lot of attaching. Something like this:\n\u003Cimg src=\"\u002Ffancybind.PNG\" alt=\"alt text\" title=\"Everything is nicer when you use a function\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EUtility functions... Can&#39;t have enough of those, right? üòÖ\u003C\u002Fp\u003E\n\u003Ch2 id=\"to-close-things-up\"\u003ETo Close Things Up\u003C\u002Fh2\u003E\n\u003Cp\u003EWhat I showed here is not necessarily the golden solution you were looking for. But it is, in my opinion, a decent workaround to an annoying problem. Overall, all this would&#39;ve been avoided by not using class based API in the first place and avoiding the use of \u003Ccode\u003Ethis\u003C\u002Fcode\u003E altogether. But we don&#39;t always have the benefit of choosing the libraries we work with. It&#39;s situations like these, when workarounds like this are valuable.\u003C\u002Fp\u003E\n",readTime:3}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');</script><script src=/client/67626b8c3455d916c80e/main.js></script> 